// Este array de objetos incluye las bandas que va a tener disponible el sitio

let bandas = [
    
    {
        id: "redhotchilipeppers",
        imgFile: "img/proximo1.jpg",
        preciobanda: 75,
        preciobandavip: 110,
        fechaBanda: "30/03/2022",
        nombreBanda: "Red Hot Chili Peppers",
        lugarBanda: "Geekbar, Wellington, NZ",
        regionBanda: "Oceanía",
        botonid: "rhcp",
        modalid: 1

    },

    {
        id: "coldplay",
        imgFile: "img/proximo2.jpg",
        preciobanda: 100,
        preciobandavip: 130,
        fechaBanda: "04/03/2022",
        nombreBanda: "Coldplay",
        lugarBanda: "CoderBar, Londres, Reino Unido",
        regionBanda: "Europa",
        botonid: "cdp",
        modalid: 2

    },

    {
        id: "twentyonepilots",
        imgFile: "img/proximo3.jpg",
        preciobanda: 80,
        preciobandavip: 110,
        fechaBanda: "07/04/2022",
        nombreBanda: "Twenty One Pilots",
        lugarBanda: "Ancient Throne, Croacia",
        regionBanda: "Europa",
        botonid: "twop",
        modalid: 3

    },

    {
        id: "maroonfive",
        imgFile: "img/proximo4.jpg",
        preciobanda: 75,
        preciobandavip: 90,
        fechaBanda: "20/05/2021",
        nombreBanda: "Maroon 5",
        lugarBanda: "Big Bang T. , Sudáfrica",
        regionBanda: "África",
        botonid: "mfive",
        modalid: 4

    },

    {
        id: "acdc",
        imgFile: "img/proximo5.jpg",
        preciobanda: 110,
        preciobandavip: 135,
        fechaBanda: "13/05/2022",
        nombreBanda: "AC/DC",
        lugarBanda: "Klusterhoefer , Alemania",
        regionBanda: "Europa",
        botonid: "acdcbtn",
        modalid: 5

    },

    {
        id: "metallica",
        imgFile: "img/proximo6.jpg",
        preciobanda: 110,
        preciobandavip: 125,
        fechaBanda: "14/06/2022",
        nombreBanda: "Metallica",
        lugarBanda: "Shinzen, China",
        regionBanda: "Asia",
        botonid: "mtc",
        modalid: 6

    },

    {
        id: "edsheeran",
        imgFile: "img/proximo7.jpg",
        preciobanda: 50,
        preciobandavip: 70,
        fechaBanda: "13/07/2022",
        nombreBanda: "Ed Sheeran",
        lugarBanda: "Huan ze, Vietnam",
        regionBanda: "Asia",
        botonid: "edsn",
        modalid: 7

    },

    {
        id: "thelumineers",
        imgFile: "img/proximo8.jpg",
        preciobanda: 35,
        preciobandavip: 125,
        fechaBanda: "09/12/2021",
        nombreBanda: "The Lumineers",
        lugarBanda: "Trip se, Polonia",
        regionBanda: "Europa",
        botonid: "tlm",
        modalid: 8

    },

    {
        id: "linkinpark",
        imgFile: "img/proximo9.jpg",
        preciobanda: 75,
        preciobandavip: 110,
        fechaBanda: "08/09/2021",
        nombreBanda: "Linkin Park",
        lugarBanda: "The Noods, Londres, Reino Unido",
        regionBanda: "Europa",
        botonid: "lp",
        modalid: 9

    },

    {
        id: "aerosmith",
        imgFile: "img/proximo10.jpg",
        preciobanda: 110,
        preciobandavip: 135,
        fechaBanda: "08/08/2021",
        nombreBanda: "Aerosmith",
        lugarBanda: "Nak, Los Angeles, California",
        regionBanda: "América del Norte",
        botonid: "asm",
        modalid: 10

    },

    {
        id: "postmalone",
        imgFile: "img/proximo11.jpg",
        preciobanda: 65,
        preciobandavip: 110,
        fechaBanda: "08/10/2021",
        nombreBanda: "Post Malone",
        lugarBanda: "Stripped, Los Angeles, California",
        regionBanda: "América del Norte",
        botonid: "pm",
        modalid: 11

    },

    {
        id: "jbalvin",
        imgFile: "img/proximo12.jpg",
        preciobanda: 35,
        preciobandavip: 60,
        fechaBanda: "14/11/2021",
        nombreBanda: "J Balvin",
        lugarBanda: "NLa Guachita, Bogotá, Colombia",
        regionBanda: "América del Sur",
        botonid: "jbn",
        modalid: 12

    },

    {
        id: "cazzu",
        imgFile: "img/proximo13.jpg",
        preciobanda: 25,
        preciobandavip: 45,
        fechaBanda: "10/10/2021",
        nombreBanda: "Cazzu",
        lugarBanda: "Milk, Córdoba, Argentina",
        regionBanda: "América del Sur",
        botonid: "caz",
        modalid: 13

    },

    {
        id: "solomun",
        imgFile: "img/proximo14.jpg",
        preciobanda: 100,
        preciobandavip: 130,
        fechaBanda: "27/11/2021",
        nombreBanda: "Solomun",
        lugarBanda: "Tuk Tuk, Tulum, México",
        regionBanda: "América del Norte",
        botonid: "smn",
        modalid: 14

    },

    {
        id: "maceoplex",
        imgFile: "img/proximo15.jpg",
        preciobanda: 90,
        preciobandavip: 110,
        fechaBanda: "28/11/2021",
        nombreBanda: "Maceo Plex",
        lugarBanda: "DGTL Festival, Países Bajos",
        regionBanda: "Europa",
        botonid: "mcp",
        modalid: 15

    },

    {
        id: "sodastereo",
        imgFile: "img/proximo16.jpg",
        preciobanda: 150,
        preciobandavip: 175,
        fechaBanda: "28/11/2021",
        nombreBanda: "Soda Stereo",
        lugarBanda: "Estadio Único La Plata, Buenos Aires, Argentina",
        regionBanda: "América del Sur",
        botonid: "sods",
        modalid: 16

    },

    {
        id: "babasonicos",
        imgFile: "img/proximo17.jpg",
        preciobanda: 35,
        preciobandavip: 60,
        fechaBanda: "25/12/2021",
        nombreBanda: "Babasónicos",
        lugarBanda: "Studio Theater, Córdoba, Argentina",
        regionBanda: "América del Sur",
        botonid: "bbsn",
        modalid: 17

    },

    {
        id: "ciroylospersas",
        imgFile: "img/proximo18.jpg",
        preciobanda: 15,
        preciobandavip: 25,
        fechaBanda: "17/01/2022",
        nombreBanda: "Ciro y Los Persas",
        lugarBanda: "El Monumental, Buenos Aires, Argentina",
        regionBanda: "América del Sur",
        botonid: "cylp",
        modalid: 18

    },

    {
        id: "lamonajimenez",
        imgFile: "img/proximo19.jpg",
        preciobanda: 10,
        preciobandavip: 25,
        fechaBanda: "15/02/2022",
        nombreBanda: "La Mona Jiménez",
        lugarBanda: "La Morocha, Córdoba, Argentina",
        regionBanda: "América del Sur",
        botonid: "lmj",
        modalid: 19

    },

    {
        id: "labarra",
        imgFile: "img/proximo20.jpg",
        preciobanda: 5,
        preciobandavip: 10,
        fechaBanda: "13/09/2021",
        nombreBanda: "La Barra",
        lugarBanda: "Cuba Inc, Córdoba, Argentina",
        regionBanda: "América del Sur",
        botonid: "lb",
        modalid: 20

    },
    

];


// Esta función va a crear e iterar las primeras 4 bandas que se muestran en "Próximos eventos"

function proxBandas () {
    
    // Creo un for que itere en bandas.lenght y que solamente muestre 4 items

    for (let i = 0; i < bandas.length && i <= 3 ; i++) {

        // Tomo el ID del div donde se van a crear las cards
        let crearCard = document.querySelector('#proximosEventos');
    
        // Con innerHTML creo las cards
        crearCard.innerHTML += `
        <div class="container-fluid col-md-3 justify-content-center align-content-center" style="margin-bottom: 2em" id="${bandas[i].id}">
        <div class="card align-items-center">
          <img src="${bandas[i].imgFile}" class="card-img-top" alt="...">
          
          <div class="card-body container row justify-content-center"></div>
            <h2>$${bandas[i].preciobanda}</h2>
            <h5>${bandas[i].fechaBanda}</h5>
            <h4 class="card-title">${bandas[i].nombreBanda}</h4>
            <p class="descripcion-evento">${bandas[i].lugarBanda} , ${bandas[i].regionBanda}</p>
            <button type="button" class="boton botonCompra btn btn-primary justify-content-center align-content-center" data-bs-toggle="modal" data-bs-target="#modalBanda" style="margin-bottom: 1.5em;" id="${i}">
            Comprar tickets
            </button>
          </div>
        </div>
      </div>`;
    
    
    }
}

// Ejecuto la función para que se muestre en el inicio
proxBandas();


// Esta funcion se va a disparar con los botones de región. Filtra los eventos según el valor de regiónbanda. 

function filteredEvents () {
    
    // Con el for creo las cards de la misma manera
    for (let i = 0; i < bandas.length && i <= 20 ; i++) {

        // Tomo el div filteredByRegion para iterarlas ahí 
        let filtradosPorRegion = document.querySelector('#filteredByRegion');
    
        // Creo las cards con innerHTML
        filtradosPorRegion.innerHTML += `
        <div class="container-fluid col-md-3 justify-content-center align-content-center" style="margin-bottom: 2em" id="${bandas[i].id}">
        <div class="card align-items-center">
          <img src="${bandas[i].imgFile}" class="card-img-top" alt="...">
          
          <div class="card-body container row justify-content-center"></div>
            <h2>$${bandas[i].preciobanda}</h2>
            <h5>${bandas[i].fechaBanda}</h5>
            <h4 class="card-title">${bandas[i].nombreBanda}</h4>
            <p class="descripcion-evento">${bandas[i].lugarBanda} , ${bandas[i].regionBanda}</p>
            <button type="button" class="boton botonCompra btn btn-primary justify-content-center align-content-center" data-bs-toggle="modal" data-bs-target="#modalBanda" style="margin-bottom: 1.5em;" id="${i}">
            Comprar tickets
            </button>
          </div>
        </div>
      </div>`;
    
    }

    // La funcion de editarModal se ejecuta luego de filtrar los eventos
    editarModal();
}

// Esta funcion se va a disparar con los botones de filtrado por mes. Filtra los eventos según el valor de fechaBanda. 

function filtradoPorMes () {
    
    // Un for para crear las cards iterandolas 
    for (let i = 0; i < bandas.length && i <= 20 ; i++) {

        // La variable para tomar el ID del div donde se van a crear las cards
        let filtradosPorFecha = document.getElementById('filteredByDate');
    
        // El innerHTML con la creación correspondiente de las cards
        filtradosPorFecha.innerHTML += `
        <div class="container-fluid col-md-3 justify-content-center align-content-center" style="margin-bottom: 2em" id="${bandas[i].id}">
        <div class="card align-items-center">
          <img src="${bandas[i].imgFile}" class="card-img-top" alt="...">
          
          <div class="card-body container row justify-content-center"></div>
            <h2>$${bandas[i].preciobanda}</h2>
            <h5>${bandas[i].fechaBanda}</h5>
            <h4 class="card-title">${bandas[i].nombreBanda}</h4>
            <p class="descripcion-evento">${bandas[i].lugarBanda} , ${bandas[i].regionBanda}</p>
            <button type="button" class="boton botonCompra btn btn-primary justify-content-center align-content-center" data-bs-toggle="modal" data-bs-target="#modalBanda" style="margin-bottom: 1.5em;" id="${i}">
            Comprar tickets
            </button>
          </div>
        </div>
      </div>`;
    
    }

    // Esta funcion es la que edita los modales según el filtro
    editarModal();
}


// Esta función edita de forma dinámica el contenido del modal en HTML. Es la funcion que voy a llamar cada vez se haga click en un boton de compra .


function editarModal() {
    
    // Con uan variable tomo todos los botones con con la clase botonCompra
    var botonesdecompra = document.getElementsByClassName('botonCompra');

    var funcionEditora = function(e) {
      


    console.log(e.target.id);
    
    // Con una variable tomo el id modalBanda para que se edite de forma dinámica con innerHTML
    let modal = document.getElementById('modalBanda');
    modal.innerHTML = `
    
                  <div class="modal-content" style="max-width:70%">
                    <div class="modal-header">
                      <h2 class="modal-title" id="modalBandaLabel">${bandas[e.target.id].nombreBanda}</h2>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                              
                      <!--Contenido del modal-->
    
                      <div class="container-fluid row justify-content-center align-content-center">
                        
                        <div class="container">
                          <img src="${bandas[e.target.id].imgFile}" alt="" class="img-fluid" style="border-radius: 20px;">
                        </div>
                        
                        <div class="container-fluid" style="margin-top:1em;">
                          
                          <div class="container-fluid" style="margin-bottom: 1em">
                            <i class="icons far fa-calendar-alt"></i> <p class="display-p">Fecha: ${bandas[e.target.id].fechaBanda}</p>
                          </div>
    
                          <div class="container-fluid" style="margin-bottom: 1em">
                            <i class="icons fas fa-map-marker-alt"></i> <p class="display-p">Lugar: ${bandas[e.target.id].lugarBanda}</p>
                          </div>
    
                        </div>
    
                        <div class="container-fluid">
                          <i class="icons fas fa-ticket-alt"></i><p class="display-p"> Entrada General: <span class="display-span">$${bandas[e.target.id].preciobanda}</span></p> 
                        </div>
    
                        <div class="container justify-content-center align-content-center">
                          <input class="barra-busqueda form-control-modal me-2" style="width:30%" type="number" placeholder="Ingresá cantidad de tickets" min="0" max="10" aria-label="tickets" id="inputTickets" >
                        </div> 

            
                        <div class="container-fluid" style="margin-top: 2em;">
                          <h3 style="font-weight: bold;" id="sumaTotalTickets">Total a pagar: $ </h3>
                        </div>
    
                      </div>
    
    
                    </div>
                    <div class="modal-footer row container-fluid justify-content-center">
                      
                      <a href="checkout.html" class="d-flex boton btn btn-primary justify-content-center align-content-center" style="width: 50%;">Confirmar compra</a>
                      
                      <button type="button" class="volver btn btn-secondary" data-bs-dismiss="modal" style="width: 50%;">Volver</button>
    
    
    
                    </div>
                  </div>
               
    
    `

    // Esta variable toma el precio de la banda segun el id
    var precio = `${bandas[e.target.id].preciobanda}`;

    // Esta variable toma el ID input tickets, que pide al usuario ingresar cantidad

    var cantidadTickets = document.getElementById('inputTickets');
    
    // Al input de los tickets le agrego un addeventlistener que tome el valor de lo que ingresa el usuario, lo convierta a entero, y sume el valor de la cantidad ingresada + el precio del ticket de la banda . Con un innerHTML lo agrego al h3 que imprime el valor.

    cantidadTickets.addEventListener('input', e => {
      e.preventDefault();
      var cantidadTotal = e.target.value.toLowerCase();

      precioTotalTickets = parseInt(cantidadTotal) * parseInt(precio);

      console.log(precioTotalTickets);

      var imprimirTotal = document.getElementById('sumaTotalTickets');

      imprimirTotal.innerHTML = `
            Total a pagar: $${precioTotalTickets}
      `

      if (cantidadTotal === '' || cantidadTotal === 0) {
        imprimirTotal.innerHTML = `
        Debes ingresar una cantidad de tickets.
          `
      }
    })
  
  };

  // Este for itera todos los botones de compra y les agrega un addeventListener a cada uno.
  for (var i = 0; i < botonesdecompra.length; i++) {
    botonesdecompra[i].addEventListener('click', funcionEditora, false);
  }

}

// Ejecuto la funcion para que los elementos ya creados se editen
editarModal();



// ------------- SEARCHBAR---------------

// Esta funcion filtra en la searchbar segun el filtro creado en jQuery

function searchBarFilter(resultadoBusqueda) {

    
    // una variable que itere los elementos de resultadoBusqueda
    for (let i = 0; i < resultadoBusqueda.length && i <= 20 ; i++) {

        // Tomo el ID del div filteredBySearch
        let filtradosBusqueda = document.getElementById('filteredBySearch');
    
        // Itero los elementos segun el filtrado
        filtradosBusqueda.innerHTML = `
        <div class="container-fluid col-md-3 justify-content-center align-content-center" style="margin-bottom: 2em" id="${resultadoBusqueda[i].id}">
        <div class="card align-items-center">
          <img src="${resultadoBusqueda[i].imgFile}" class="card-img-top" alt="...">
          
          <div class="card-body container row justify-content-center"></div>
            <h2>$${resultadoBusqueda[i].preciobanda}</h2>
            <h5>${resultadoBusqueda[i].fechaBanda}</h5>
            <h4 class="card-title">${resultadoBusqueda[i].nombreBanda}</h4>
            <p class="descripcion-evento">${resultadoBusqueda[i].lugarBanda} , ${resultadoBusqueda[i].regionBanda}</p>
            <button type="button" class="boton botonCompra btn btn-primary justify-content-center align-content-center" data-bs-toggle="modal" data-bs-target="#modalBanda" style="margin-bottom: 1.5em;" id="${i}">
            Comprar tickets
            </button>
          </div>
        </div>
      </div>`;
    
    }
    
    
    
    
}

// -------------- BOTON VER MÁS--------------------

// Creo una variable "displayMore = ver más en ingles". La agarro con elementbyId y le agrego el eventlistener que va a hacer que vaya mostrando el resto de los eventos cada vez que le hago click al boton .

let displayMore = document.getElementById("verMas").addEventListener("click", mostrarBandas);


// Esta variable empieza en 4, ya que los 4 primeros elementos se muestran con el for previo de más arriba
var posicion = 4;

//La funcion del addeventListener que va creando el resto de las cards cada vez que el boton es apretado
function mostrarBandas() { 

    
    for(let i=posicion; i < (posicion +4); i++) {
        let crearCard = document.querySelector('#proximosEventos');
    
        crearCard.innerHTML += `
        <div class="container-fluid col-md-3 justify-content-center align-content-center" style="margin-bottom: 2em" id="${bandas[i].id}" data-aos="fade-down"
        data-aos-easing="linear"
        data-aos-duration="800">
        <div class="card align-items-center">
          <img src="${bandas[i].imgFile}" class="card-img-top" alt="...">
          
          <div class="card-body container row justify-content-center"></div>
          
            <h2>$${bandas[i].preciobanda}</h2>
            <h5>${bandas[i].fechaBanda}</h5>
            <h4 class="card-title">${bandas[i].nombreBanda}</h4>
            <p class="descripcion-evento">${bandas[i].lugarBanda} , ${bandas[i].regionBanda}</p>
            <button type="button" class="boton botonCompra btn btn-primary justify-content-center align-content-center" data-bs-toggle="modal" data-bs-target="#modalBanda" style="margin-bottom: 1.5em;" id="${i}">
            Comprar tickets
            </button>
          </div>
        </div>
      </div>`;

      editarModal();
    }

    posicion = posicion + 4;

    

    // Cuando posición llegue a 20, se ejecutará lo siguiente:

    if(posicion === 20) {
        // La visibilidad es hidden cuando llega al tope de los elementos (20)
        document.getElementById('verMas').style.display="none";
    } 
    


}




// ----------------LOCAL STORAGE ---------------


// En localStorage lo que quiero hacer es guardar el array de las bandas

const guardarLocal = (clave, valor) => { localStorage.setItem(clave, valor) }

for (const banda of bandas) {
    guardarLocal(banda.nombreBanda, JSON.stringify(banda));
}

// Almaceno el listado de bandas para que cuando el usuario loguee nuevamente estén guardados los valores
guardarLocal("infoBandas", JSON.stringify(bandas));


